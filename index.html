<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AWEZA TV - Fixed FullScreen</title>
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
    <style>
        :root { --main: #e50914; --bg: #0b0b0b; --card: #1a1a1a; }
        body, html { background-color: var(--bg); color: white; font-family: sans-serif; margin: 0; padding: 0; height: 100%; width: 100%; overflow: hidden; }
        
        /* Ø³Û•Ø±Ù¾Û•Ú•Û• */
        header { height: 60px; padding: 0 15px; background: #000; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--main); position: relative; z-index: 10; }
        .logo-text { font-size: 18px; font-weight: bold; color: var(--main); }

        /* ØªØ§ØªÛ•Ú©Ø§Ù† */
        .tabs { display: flex; background: #111; border-bottom: 1px solid #333; position: relative; z-index: 10; }
        .tab { flex: 1; padding: 12px; text-align: center; cursor: pointer; font-size: 14px; color: #888; }
        .tab.active { color: var(--main); border-bottom: 2px solid var(--main); font-weight: bold; }

        /* Ø¨Û•Ø´ÛŒ Ù¾Ù„Û•ÛŒÛ•Ø± */
        .player-container { width: 100%; background: #000; height: 30vh; position: relative; z-index: 5; }
        .video-js { width: 100%; height: 100%; }

        /* Ø¨Û•Ø´ÛŒ Ù„ÛŒØ³Øª */
        .content-section { height: calc(70vh - 110px); overflow-y: auto; padding: 15px; position: relative; z-index: 5; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 12px; }
        
        .card { background: var(--card); border-radius: 12px; padding: 12px 5px; text-align: center; cursor: pointer; border: 1px solid #333; position: relative; }
        .fav-btn { position: absolute; top: 0; left: 0; font-size: 22px; color: rgba(255,255,255,0.2); padding: 8px; z-index: 30; }
        .fav-btn.is-fav { color: var(--main) !important; }
        
        .ch-logo { width: 45px; height: 45px; margin-bottom: 5px; object-fit: contain; pointer-events: none; }
        .ch-name { font-size: 11px; font-weight: bold; pointer-events: none; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* --- Ø¦Û•Ù… Ø¨Û•Ø´Û• Ú©ÛØ´Û•Ú©Û•ÛŒ Ú†Ø§Ø±Û•Ø³Û•Ø± Ú©Ø±Ø¯ --- */
        @media screen and (orientation: landscape) {
            body { overflow: hidden; }
            .player-container { 
                position: fixed; top: 0; left: 0; 
                width: 100vw !important; height: 100vh !important; 
                z-index: 9999; 
            }
            header, .tabs, .content-section { visibility: hidden; pointer-events: none; }
        }

        @media screen and (orientation: portrait) {
            .player-container { position: relative; width: 100%; height: 30vh; z-index: 5; }
            header, .tabs, .content-section { visibility: visible; pointer-events: auto; }
        }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 10000; justify-content: center; align-items: center; }
        .modal-content { background: #1a1a1a; padding: 25px; border-radius: 20px; width: 85%; max-width: 350px; text-align: center; }
        .opt-btn { display: block; width: 100%; padding: 14px; margin: 10px 0; background: #333; color: white; border-radius: 10px; border: none; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<header id="h-part">
    <div class="logo-text">AWEZA TV</div>
    <button style="background:none; border:none; color:white; font-size:20px; cursor:pointer;" onclick="toggleModal()">âš™ï¸</button>
</header>

<div class="player-container" id="mainPlayerWrap">
    <video id="player" class="video-js vjs-default-skin vjs-big-play-centered" controls preload="auto" playsinline></video>
</div>

<div class="tabs" id="t-part">
    <div class="tab active" id="allTab" onclick="switchTab('all')">Ù‡Û•Ù…ÙˆÙˆ Ú©Û•Ù†Ø§ÚµÛ•Ú©Ø§Ù†</div>
    <div class="tab" id="favTab" onclick="switchTab('fav')">â¤ï¸ Ø¯ÚµØ®ÙˆØ§Ø²Û•Ú©Ø§Ù†</div>
</div>

<div class="content-section" id="c-part">
    <div class="grid" id="list"></div>
</div>

<div class="modal" id="settingsModal">
    <div class="modal-content">
        <h3 style="color:var(--main);">Ú•ÛÚ©Ø®Ø³ØªÙ†</h3>
        <button class="opt-btn" onclick="document.getElementById('fileInput').click()">ğŸ“ Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ M3U</button>
        <button class="opt-btn" onclick="addManual()">âœï¸ Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ø¯Û•Ø³ØªÛŒ</button>
        <hr style="border:0.5px solid #333; margin:15px 0;">
        <button class="opt-btn" style="background:#444;" onclick="clearFavs()">â¤ï¸ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø¯ÚµØ®ÙˆØ§Ø²Û•Ú©Ø§Ù†</button>
        <button class="opt-btn" style="background:#e5091422; color:var(--main);" onclick="clearAll()">ğŸ—‘ï¸ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ú¯Ø´Øª</button>
        <input type="file" id="fileInput" accept=".m3u,.txt" onchange="handleFile(event)" style="display:none;">
        <button onclick="toggleModal()" style="background:none; border:none; color:white; margin-top:20px; cursor:pointer;">Ø¯Ø§Ø®Ø³ØªÙ†</button>
    </div>
</div>

<script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
<script>
    const videoPlayer = videojs('player');
    const listContainer = document.getElementById('list');
    let allChannels = JSON.parse(localStorage.getItem('iptv_data')) || [];
    let favorites = JSON.parse(localStorage.getItem('iptv_favs')) || [];
    let currentTab = 'all';

    function toggleModal() {
        const m = document.getElementById('settingsModal');
        m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
    }

    function switchTab(t) {
        currentTab = t;
        document.getElementById('allTab').classList.toggle('active', t === 'all');
        document.getElementById('favTab').classList.toggle('active', t === 'fav');
        render();
    }

    function handleFile(e) {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = function(event) {
            const lines = event.target.result.split('\n');
            let newList = [];
            let name = '', logo = '';
            lines.forEach(line => {
                line = line.trim();
                if (line.startsWith('#EXTINF:')) {
                    const lm = line.match(/tvg-logo="([^"]+)"/);
                    logo = lm ? lm[1] : '';
                    name = line.split(',').pop();
                } else if (line.startsWith('http')) {
                    newList.push({ name: name || 'Ú©Û•Ù†Ø§Úµ', url: line, logo: logo });
                    name = ''; logo = '';
                }
            });
            allChannels = [...allChannels, ...newList];
            save(); render(); toggleModal();
        };
        reader.readAsText(file);
    }

    function addManual() {
        const n = prompt("Ù†Ø§Ùˆ:"); const u = prompt("Ù„ÛŒÙ†Ú©:");
        if (n && u) { allChannels.push({ name: n, url: u, logo: '' }); save(); render(); toggleModal(); }
    }

    function toggleFav(url, event) {
        event.stopPropagation();
        const index = favorites.indexOf(url);
        if (index > -1) favorites.splice(index, 1);
        else favorites.push(url);
        localStorage.setItem('iptv_favs', JSON.stringify(favorites));
        render();
    }

    function clearFavs() {
        if(confirm("Ø¯ÚµØ®ÙˆØ§Ø²Û•Ú©Ø§Ù† Ù¾Ø§Ú©Ø¨Ú©Ø±ÛÙ†Û•ÙˆÛ•ØŸ")) { favorites = []; localStorage.setItem('iptv_favs', "[]"); render(); toggleModal(); }
    }

    function clearAll() {
        if(confirm("Ù‡Û•Ù…ÙˆÙˆ Ú©Û•Ù†Ø§ÚµÛ•Ú©Ø§Ù† Ø¨Ø³Ú•ÛÙ†Û•ÙˆÛ•ØŸ")) { allChannels = []; favorites = []; localStorage.clear(); render(); toggleModal(); }
    }

    function save() { localStorage.setItem('iptv_data', JSON.stringify(allChannels)); }

    function render() {
        listContainer.innerHTML = '';
        const data = currentTab === 'all' ? allChannels : allChannels.filter(ch => favorites.includes(ch.url));
        data.forEach((ch) => {
            const isFav = favorites.includes(ch.url);
            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = `
                <div class="fav-btn ${isFav ? 'is-fav' : ''}" onclick="toggleFav('${ch.url}', event)">â¤</div>
                <img src="${ch.logo || 'https://cdn-icons-png.flaticon.com/512/716/716429.png'}" class="ch-logo">
                <div class="ch-name">${ch.name}</div>
            `;
            div.onclick = () => {
                videoPlayer.src({ src: ch.url, type: 'application/x-mpegURL' });
                videoPlayer.play();
                document.querySelectorAll('.card').forEach(c => c.style.borderColor = "#333");
                div.style.borderColor = "var(--main)";
            };
            listContainer.appendChild(div);
        });
    }
    render();
</script>
</body>
</html>
